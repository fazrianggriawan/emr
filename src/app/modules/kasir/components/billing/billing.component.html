<div class="row">
    <div class="col">
        <div class="pb-2">
            <button class="btn btn-light btn-sm mr-1" (click)="printBilling()"><i class="bi bi-printer"></i> Print Billing</button>
            <!-- <button class="btn btn-outline-light btn-xs p-1 pl-2 pr-2 mr-1"><i class="bi bi-filetype-xls"></i> XLS</button>
            <button class="btn btn-outline-light btn-xs p-1 pl-2 pr-2 mr-1"><i class="bi bi-trash"></i> Hapus</button> -->
        </div>
        <div class="border-bottom pb-2">
            <p-selectButton [options]="catTarif" [(ngModel)]="selectedCatTarif" optionLabel="name"></p-selectButton>
        </div>
        <!-- <div>
            <ag-grid-angular></ag-grid-angular>
        </div> -->
        <table class="table table-striped table-hover border-bottom">
            <thead>
                <tr>
                    <th>Tanggal</th>
                    <th>Nama Tarif</th>
                    <th>Dokter</th>
                    <th>Harga</th>
                    <th>Qty</th>
                    <th>Disc %</th>
                    <th>Total</th>
                    <th>&nbsp;</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of dataBilling; let idx = index">
                    <td>{{appService.dateHuman(item.tgl_tindakan)}}</td>
                    <td>{{item.r_tarif_harga.r_tarif.name | uppercase}}</td>
                    <td>
                        <ng-container *ngFor="let jasa of item.r_billing_jasa">
                            <a class="link text-primary" *ngIf="jasa.r_pelaksana.group == 'dokter'">{{jasa.r_pelaksana.name}}</a>
                        </ng-container>
                    </td>
                    <td>{{item.r_tarif_harga.harga | number}}</td>
                    <td><a class="link text-primary" (click)="openOpJumlah($event, item)">{{item.qty}}</a></td>
                    <td><a class="link text-primary" (click)="openOpDisc($event, item)">{{item.discount}}%</a></td>
                    <td>{{this.billingService.hitungTotalBilling(item) | number}}</td>
                    <td>
                        <button class="btn btn-icon"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<p-overlayPanel #opDisc>
    <ng-template pTemplate>
        Disc %
        <div class="input-group">
            <input type="text" class="form-control" [(ngModel)]="selectedBilling.discount" placeholder="Discount %" aria-label="Discount %" aria-describedby="button-addon2">
            <div class="input-group-append">
                <button class="btn btn-primary btn-icon" type="button" (click)="addDiscount()" [disabled]="true">
                    <!-- <i class="bi bi-check-lg"></i> -->
                    <div class="spinner-border spinner-border-sm" role="status"></div>
                </button>
                <button class="btn btn-light btn-icon" type="button"><i class="bi bi-x-lg"></i></button>
            </div>
        </div>
    </ng-template>
</p-overlayPanel>

<p-overlayPanel #opJumlah>
    <ng-template pTemplate>
        Jumlah
        <div class="input-group">
            <input type="number" class="form-control"  [(ngModel)]="selectedBilling.qty" placeholder="Qty" aria-label="Qty" aria-describedby="button-addon2">
            <div class="input-group-append">
                <button class="btn btn-primary btn-icon" (click)="updateJumlah()" type="button"><i class="bi bi-check-lg"></i></button>
                <button class="btn btn-light btn-icon" type="button"><i class="bi bi-x-lg"></i></button>
            </div>
        </div>
    </ng-template>
</p-overlayPanel>

<p-confirmPopup></p-confirmPopup>