<div class="row">
    <div class="col">
        <div class="row border-bottom pd-b-10">
            <div class="col-auto border-right">
                <h5>Tarif</h5>
            </div>
            <div class="col-auto">
                <button class="btn btn-sm btn-primary" (click)="tambahTarif()"><i class="bi bi-plus-lg"></i> Tambah Tarif</button>
            </div>
        </div>

        <div class="row mg-t-10">
            <div class="col">
                <p-table
                    #dt
                    [value]="dataTarif"
                    [rowHover]="true"
                    [paginator]="true"
                    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                    [filterDelay]="0"
                    [rows]="10"
                    [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]"
                    [globalFilterFields]="['name','r_tarif_harga.harga','active']"
                    styleClass="p-datatable-sm p-datatable-striped">
                    <ng-template pTemplate="header">
                        <tr>
                            <th pSortableColumn="name">Keterangan <p-sortIcon field="name"></p-sortIcon></th>
                            <th pSortableColumn="r_tarif_harga.harga">Harga <p-sortIcon field="r_tarif_harga.harga"></p-sortIcon></th>
                            <th pSortableColumn="r_tarif_harga_jasa.total">Total Jasa <p-sortIcon field="r_tarif_harga_jasa.total"></p-sortIcon></th>
                            <th style="width: 130px;">Selisih</th>
                            <th pSortableColumn="r_tarif_category.r_group_tarif.r_group.name">Group <p-sortIcon field="r_tarif_category.r_group_tarif.r_group.name"></p-sortIcon></th>
                            <th pSortableColumn="r_tarif_category.r_cat_tarif.name">Category  <p-sortIcon field="r_tarif_category.r_cat_tarif.name"></p-sortIcon></th>
                            <th style="width: 100px;" pSortableColumn="active">Status <p-sortIcon field="active"></p-sortIcon></th>
                            <th>&nbsp;</th>
                        </tr>
                        <tr>
                            <th><p-columnFilter matchMode="contains" placeholder="All" [showMenu]="false" type="text" field="name"></p-columnFilter></th>
                            <th><p-columnFilter matchMode="contains" placeholder="All" [showMenu]="false" type="text" field="r_tarif_harga.harga"></p-columnFilter></th>
                            <th><p-columnFilter matchMode="equals" placeholder="All" [showMenu]="false" type="text" field="r_tarif_harga_jasa.total"></p-columnFilter></th>
                            <th></th>
                            <th style="width: 100px;">
                                <p-columnFilter field="r_tarif_category.r_group_tarif.r_group.name" matchMode="equals" [showMenu]="false">
                                    <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                        <p-dropdown [ngModel]="value" [options]="optionsGroupTarif" optionValue="name" (onChange)="filter($event.value)" placeholder="All" [showClear]="true">
                                            <ng-template let-option pTemplate="item">
                                                {{option.name}}
                                            </ng-template>
                                            <ng-template pTemplate="selectedItem">
                                                {{value}}
                                            </ng-template>
                                        </p-dropdown>
                                    </ng-template>
                                </p-columnFilter>
                            </th>
                            <th>
                                <p-columnFilter matchMode="contains" [showMenu]="false" type="text" field="r_tarif_category.r_cat_tarif.name" placeholder="All"></p-columnFilter>
                            </th>
                            <th>
                                <p-columnFilter field="active" matchMode="equals" [showMenu]="false">
                                    <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                        <p-dropdown [ngModel]="value" [options]="optionsStatus" optionValue="id" (onChange)="filter($event.value)" placeholder="All" [showClear]="true">
                                            <ng-template let-option pTemplate="item">
                                                {{option.name}}
                                            </ng-template>
                                            <ng-template pTemplate="selectedItem">
                                                {{value}}
                                            </ng-template>
                                        </p-dropdown>
                                    </ng-template>
                                </p-columnFilter>
                            </th>
                            <th></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-item>
                        <tr class="clickable" >
                            <td (click)="getTarifHarga(item)">{{item.name | uppercase}}</td>
                            <td (click)="getTarifHarga(item)">
                                {{item.r_tarif_harga.harga | number}}
                            </td>
                            <td (click)="getTarifHarga(item)">
                                {{item.r_tarif_harga_jasa.total | number}}
                            </td>
                            <td style="width: 130px;" (click)="getTarifHarga(item)">
                                {{(item.r_tarif_harga.harga - item.r_tarif_harga_jasa.total) | number}}
                            </td>
                            <td (click)="getTarifHarga(item)">
                                {{item.r_tarif_category.r_group_tarif.r_group.name | uppercase}}
                            </td>
                            <td (click)="getTarifHarga(item)">
                                {{item.r_tarif_category.r_cat_tarif.name | uppercase}}
                            </td>
                            <td style="width: 100px;">
                                <span class="badge badge-success" *ngIf="item.active == 1">Active</span>
                                <span class="badge badge-secondary clickable" (click)="activateTarif($event, item.id)" *ngIf="item.active == 0">Non Active</span>
                            </td>
                            <td>
                                <button class="btn btn-sm btn-outline-danger" (click)="deleteTarif($event, item.id)"><i class="bi bi-trash"></i></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </div>
    </div>
</div>

<app-detail-tarif></app-detail-tarif>

<p-confirmPopup></p-confirmPopup>